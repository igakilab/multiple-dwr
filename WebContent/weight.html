<html lang="ja">
<head>
<script type="text/javascript" src="dwr/engine.js"></script>
<script type="text/javascript" src="dwr/util.js"></script>
<script type="text/javascript" src="js/jquery-2.1.4.min.js"></script>
<script type="text/javascript" src="js/jquery.serialize.js"></script>
<script type="text/javascript" src="dwr/interface/WeightTransition.js"></script>
<script type="text/javascript" src="http://www.google.com/jsapi"></script>
<script type="text/javascript">
	google.load("visualization", "1", {
		packages : [ "corechart" ]
	});

	//jqueryの画面が表示されたときに呼ばれるメソッド
	$(function() {
		var wDate = new Date(2015,9,20);
		WeightTransition.execute(wDate,{
			callback : function(data) {
				/* valにArrayListの値が順番に入る．val.weightで体重，val.dateで日時を取得できる．
				Monthは0からになっているので，1足す
				             参考： http://tacamy.hatenablog.com/entry/2013/03/14/220831
				 */
				$.each(data, function(index, val) {
					$('#weightTransitionReply').append(
							val.date.getMonth() + 1 + "月" + val.date.getDate()
									+ "日" + "," + val.weight + "," + val.height + "</br>");
					console.log(val);
				});
				$('#error_message').text("");

				//グラフ表示
				//参考：http://qiita.com/tadsato/items/73eabb8c46244bcc4f5d
				//http://www.itdashboard.go.jp/DataFeeds/sampleGc
				var weightData = new google.visualization.DataTable();
				weightData.addRows(7);
				weightData.addColumn("string","年月");
				weightData.addColumn("number","体重");
				weightData.addColumn("number","身長");
				$.each(data, function(index, val) {
					weightData.setValue(index,0,val.date.getMonth() + 1 + "月" + val.date.getDate()+ "日");
					weightData.setValue(index,1,val.weight)
					weightData.setValue(index,2,val.height)
				});

				var options = {
					title : '身長体重推移',
					hAxis : {
						title : '月日'
					},
					vAxis : {
						title : 'kg:cm'
					},
					width : 500,
					height : 250,
					pointSize : 6
				};

				var chart = new google.visualization.LineChart(document
						.getElementById('weightChart'));
				chart.draw(weightData, options);

			},
			errorHandler : updateErrorMessage
		});
	});
	function updateErrorMessage(message, exception) {
		$('#error_message').text(message);
		$('#csprinterReply').text("");
	}
</script>
</head>
<body>
	<p>
		Reply: <span id="weightTransitionReply"></span>
	</p>
	<p>
		<span id="error_message" class="error"></span>
	</p>
	<div id="weightChart" style="width: 800px;"></div>
</body>
</html>
